# 颜色和纹理

## 将纹理图像映射到图形上去

## 使用多个纹理图像

片元着色器怎样进行逐片元操作？

1. 谁来确定三角形的三个顶点？
2. 为了填充内部，谁来确定哪些像素需要被着色？
3. 谁来调用片元着色器？
4. 片元着色器怎么处理每个片元（像素）？

纹理映射：将一张图像，映射到一个几何图形的表面上去（就像一张贴纸）
作用：根据纹理图像，为之前光栅化后的每个片元图上合适的颜色； `组成纹理图像的像素被称为纹素` ；

webgl中使用纹理映射的步骤：

1. 准备好映射到几何图形上的纹理图像；
2. 为几何图形配置纹理映射方式；( `确定几何图形的某个片元的颜色如何取决于纹理图像中的那个像素` )
  + 利用图形的顶点坐标确定屏幕上哪部分被纹理图像覆盖，使用纹理坐标来确定纹理图像的那部分将覆盖到几何图形上；
3. 加载纹理图像，对其进行一些配置，以在webgl中使用它；
4. 在片元着色器中将相应的纹素从纹理中抽取出来，并将纹素的颜色赋给片元；

纹理坐标：纹理图像上的坐标（二维的，为了区分广泛使用的x, y坐标，webgl使用，s, t命名纹理坐标 `s,t坐标系统`
* 纹理坐标四个角： （0，0） （1，0） （1，1） （0，1）
* 左下角为坐标原点；

## 纹理坐标映射到webgl坐标系统：

``` 
webgl坐标：
-1, 1, 0  1, 1, 0
-1, -1, 0 1, -1, 0
纹理坐标：
1, 0 1, 1
0, 0 1, 0
一一映射；
```

* 创建纹理对象:
* `gl.createTexture()` : 创建webgl系统中管理纹理的对象; 
* webgl系统中的纹理对象; 
* `gl.TEXTURE0` 到 `gl. TEXTURE7` 是管理纹理图像的8个纹理单元，每一个都与 `gl.TEXTURE2D` 相关; 

* 对图像进行 `y` 轴翻转:
* `gl.pixelStorei(gl. UNPACK_FLIP_Y_WEBGL, 1)` : webgl纹理坐标系中的t轴的方向和png, bmp, jpg等格式图片的坐标系的y轴方向是相反的，所以要对图像进行y轴翻转; 

* 激活纹理单元:
* `gl.activeTexture()` : webgl通过一种纹理单元的机制，同时使用多个纹理，每个纹理单元由一个单元编号来管理一张纹理单元， `即使你的程序只有一张纹理图像`
* 系统支持的纹理单元个数取决于：硬件和浏览器的webgl实现；

* 绑定纹理对象:
* `gl.bindTexture()` : 告诉webgl系统纹理对象使用的是哪种类型的纹理;
  + 纹理的类型 
    - `gl.TEXTURE_2D` :二维纹理; (glsl es中,`sampler2D`类型专门用来处理)
    - `gl.TEXTURE_CUBE_MAP` : 立方体纹理; (glsl es中,`samplerCube`类型专门处理)

* 配置纹理对象的参数:
* `gl.texParameteri()` : 设置纹理图像映射到图形上的具体方式
* 如何根据纹理坐标获取纹素颜色，按哪种方式重复填充纹理

* 将纹理图像分配给纹理对象:
* `gl.texImage2D()` : 允许你告诉webgl系统关于改图像的一些特性; 

* 将纹理单元传递给片元着色器:
* `gl.uniform1i()` : 纹理图像传入webgl系统, 就必须将其传入片元着色器, 并映射到图形的表面上去; 

## 使用多幅纹理

* 纹理单元就是为了这个目的设计的，处理多幅纹理；
